<typeknowledge os="linux">
<!--
    <ruleincludes>
        <ruleinclude>/path/to/rules</ruleinclude>
        <ruleinclude>/path/to/more/rules</ruleinclude>
    </ruleincludes>
-->

    <scriptincludes>
        <scriptinclude>../scripts</scriptinclude>
    </scriptincludes>

<!--    <include>morerules.xml</include>-->

    <rules>
        <rule>
            <name>modules</name>
            <description>
                Variable "modules" is head of "struct module" objects.
            </description>
            <filter>
                <datatype>struct</datatype>
                <typename>list_head</typename>
                <variablename>modules</variablename>
                <fields>
                    <field match="wildcard">*</field>
                </fields>
            </filter>
            <action src="inline">
                // var inst = instance to check
                // var fields = array of requested field(s)
                inst = inst.Member(fields[0]);
                inst.ChangeType("module");
                inst.AddToAddress(inst.MemberOffset("list"));
                return inst;
            </action>
        </rule>

        <rule>
            <name>module.list</name>
            <description>
                Field "list" in "struct module" points to further  module
                objects.
            </description>
            <filter>
                <datatype>struct</datatype>
                <typename>module</typename>
                <fields>
                    <field>list</field>
                    <field match="wildcard">*</field>
                </fields>
            </filter>
            <action src="inline">
                // var inst = instance to check
                // var fields = array of requested field(s)
                inst = inst.Member(fields[0]);
                inst.ChangeType("module");
                inst.AddToAddress(inst.MemberOffset("list"));
                return inst;
            </action>
        </rule>

<!--
        <rule architecture="x86" os="linux" minversion="2.6.12" maxversion="2.6.38">
            <name>Wildcards</name>
            <filter>
                <datatype>struct,union</datatype>
                <variablename match="wildcard">__percpu__*</variablename>
                <typename>bar</typename>
                <fields>
                    <field>bar</field>
                </fields>
            </filter>
            <action src="file" file="samplerule.js">println</action>
        </rule>
-->
    </rules>
</typeknowledge>
