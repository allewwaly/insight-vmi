<?xml version="1.0" encoding="UTF-8"?>
<!--
	File created by Christian Schneider <chrschn@sec.in.tum.de>
-->
<typeknowledge version="1">
	<rules>
		<!--
			The idr_layer is organized similar to a radix tree: the usage of the
			"ary" array depends on the "layer" value. With a value > 1, it is
			still a node, otherwise it becomes a leaf.
		-->
		<rule priority="101">
			<name>idr_layer.ary</name>
			<description>Forbit access to the "ary" member in leaf nodes.</description>
			<filter>
				<datatype>struct</datatype>
				<typename>idr_layer</typename>
				<members>
					<member>ary</member>
				</members>
			</filter>
			<action type="inline">
				var inst = arguments[0];
				var layer = inst.layer.toInt32();
				if (layer > 1)
					return false;
				else
					return new Instance();
			</action>
		</rule>
	</rules>
</typeknowledge>
